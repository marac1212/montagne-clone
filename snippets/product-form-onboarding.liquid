{%- liquid
  assign atc_button_color = settings.atc_button_color
  assign atc_button_style = settings.atc_button_style
  assign atc_button_size = settings.atc_button_size
  assign color_swatches_type = settings.color_swatches_type
  assign variants_style = settings.variants_style
  assign show_quantity = block.settings.show_quantity
  assign show_payment_button = false
  if block.settings.show_payment_button and settings.enable_accept_terms == false and gift_card_recipient_feature_active == false
    assign show_payment_button = true
  endif

  if settings.atc_show_product_price
    capture product_price
      if currency_code_enable
        echo 1999 | money_with_currency
      else
        echo 1999 | money
      endif
    endcapture
  endif

  assign enable_variant_boxes = false
  if variants_style == 'boxes' or variants_style == 'auto'
    assign enable_variant_boxes = true
  endif

  capture selector_wrapper_class_swatches
    echo 'selector-wrapper'
    if enable_variant_boxes
      echo ' selector-wrapper--boxes'
    endif
    if color_swatches_type != 'disabled'
      echo ' selector-wrapper--swatches'
    endif
  endcapture

  capture selector_wrapper_class
    echo 'selector-wrapper'
    echo ' selector-wrapper--grid'
    if enable_variant_boxes
      echo ' selector-wrapper--boxes'
    endif
  endcapture

  assign size_label = 'homepage.onboarding.size' | t
  if label_text_caps
    assign size_label = size_label | replace: 'ß', '<span style="text-transform: lowercase;">ß</span>'
  endif
-%}

{%- capture quantity_selector -%}
<div class="select__fieldset">
  <span class="select__label label-typography" id="{{ section.id }}-select-quantity-label">{{ 'products.product.quantity.quantity' | t }}</span>

  {%- if settings.quantity_style == 'dropdown' -%}
    <popout-select class="select-popout select-popout--small" data-popout-prevent="true">
      <button type="button" class="select-popout__toggle{% if variants_style == 'boxes' %} select-popout__toggle--qty{% endif %}" aria-expanded="false" aria-controls="{{ section.id }}-select-quantity" aria-labelledby="{{ section.id }}-select-quantity-label" data-popout-toggle data-popout-quantity>
        <span class="select-popout__value" data-popout-text data-quantity-select>1</span>
        {%- render 'icon-select' -%}
      </button>

      <div id="{{ section.id }}-select-quantity" class="select-popout__list" data-popout-list>
        <ul class="select-popout__list__scroll">
          {%- for idx in (1..10) -%}
            <li class="select-popout__item {% if forloop.index == 1 %}select-popout__item--current{% endif %}">
              <a class="select-popout__option" href="#" {% if forloop.index == 1 %}aria-current="true"{% endif %} data-value="{{ forloop.index }}" data-popout-option>
                <span>{{ forloop.index }} {% if forloop.last %}+{% endif %}</span>
              </a>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    </popout-select>
  {%- endif -%}

  <quantity-counter class="quantity-selector" data-quantity-holder>
    <label for="product-quantity-buttons-{{ section.id }}" class="label-hidden">{{ 'products.product.quantity.quantity' | t }}</label>

    <button type="button" class="quantity__btn quantity__btn--decrease" data-quantity-minus data-quantity-button tabindex="0" title="{{ 'general.accessibility.decrease' | t }} - {{ product.title | strip_html -}}">
      <span class="visually-hidden">{{ 'general.accessibility.decrease' | t }}</span>
      {%- render 'icon-toggle-minus' -%}
    </button>

    <input id="product-quantity-buttons-{{ section.id }}" type="number" class="quantity__selector quantity__input" value="1" min="1" aria-label="quantity" autocomplete="off" name="quantity" data-quantity-field title="{{- 'products.product.quantity.quantity' | t }} - {{ product.title | strip_html -}}" pattern="[0-9]*" />

    <button type="button" class="quantity__btn quantity__btn--increase" data-quantity-plus data-quantity-button tabindex="0" title="{{- 'general.accessibility.increase' | t }} - {{ product.title | strip_html -}}">
      <span class="visually-hidden">{{ 'general.accessibility.increase' | t }}</span>
      {%- render 'icon-toggle-plus' -%}
    </button>
  </quantity-counter>
</div>
{%- endcapture -%}

<div class="product__form product__form--onboarding">
  <div class="product__selectors">
    <div
      class="{{ selector_wrapper_class_swatches }}"
      data-option-position="1"
      {% if animations_enabled %}
        data-aos="hero"
        data-aos-anchor="{{ animation_anchor }}"
        data-aos-order="{{ animation_order }}"
        {%- assign animation_order = animation_order | plus: 1 -%}
      {% endif %}
    >
      {%- if enable_variant_boxes or color_swatches_type != 'disabled' -%}
        <fieldset class="radio__fieldset radio__fieldset--{{ settings.color_swatches_product_style }}">
          <legend class="radio__legend">
            <span class="radio__legend__label label-typography">{{- 'homepage.onboarding.color' | t -}}</span>
          </legend>

          {%- if color_swatches_type != 'disabled' -%}
            {%- render 'product-swatch--onboarding' -%}
          {%- else -%}
            {%- for i in (1..3) -%}
              {%- capture value -%}{%- cycle 'White', 'Grey', 'Black' -%}{%- endcapture -%}
              <span class="radio__button">
                <input
                  type="radio"
                  class="radio__input"
                  data-single-option-selector
                  data-index="option1"
                  name="color--{{ section.id }}"
                  value="{{ value | escape_once }}"
                  id="option-{{ value }}-0-{{ section.id }}"
                  {% if forloop.index == 1 %}
                    checked
                  {% endif %}
                >
                <label for="option-{{ value }}-0-{{ section.id }}" class="radio__label">
                  <span>{{ value | escape_once }}</span>
                </label>
              </span>
            {%- endfor -%}
          {%- endif -%}
        </fieldset>
      {%- else -%}
        <div class="select__fieldset">
          <span class="radio__legend">
            <span class="radio__legend__label label-typography" id="onboarding-{{ section.id }}-option-0-label">
              {{- 'homepage.onboarding.color' | t -}}
            </span>
          </span>

          <popout-select class="select-popout" data-popout-prevent="true">
            <button
              type="button"
              class="select-popout__toggle"
              aria-expanded="false"
              aria-controls="onboarding-{{ section.id }}-option-0-list"
              aria-labelledby="onboarding-{{ section.id }}-option-0-label"
              data-popout-toggle
            >
              <span class="select-popout__value" data-popout-text>White</span>
              {%- render 'icon-select' -%}
            </button>

            <div id="onboarding-{{ section.id }}-option-0-list" class="select-popout__list" data-popout-list>
              <ul class="select-popout__list__scroll">
                {%- for i in (1..3) -%}
                  {%- capture value -%}{%- cycle 'White', 'Grey', 'Black' -%}{%- endcapture -%}
                  <li class="select-popout__item{% if forloop.index == 1 %} select-popout__item--current{% endif %}">
                    <a
                      class="select-popout__option"
                      href="#"
                      {% if forloop.index == 1 %}
                        aria-current="true"
                      {% endif %}
                      data-value="{{ value | escape_once }}"
                      data-popout-option
                    >
                      <span>
                        {{ value | escape_once }}
                      </span>
                    </a>
                  </li>
                {%- endfor -%}
              </ul>
            </div>
            <input
              type="hidden"
              name="options[Color]"
              id="onboarding-{{ section.id }}-option-0"
              value="White"
              data-popout-input
              data-single-option-selector
              data-index="option1"
            >
          </popout-select>
        </div>
      {%- endif -%}
    </div>

    <div
      class="selector-wrapper{% if enable_variant_boxes %} selector-wrapper--boxes{% endif %}"
      data-selector-wrapper
      data-option-position="2"
      {% if animations_enabled %}
        data-aos="hero"
        data-aos-anchor="{{ animation_anchor }}"
        data-aos-order="{{ animation_order }}"
        {%- assign animation_order = animation_order | plus: 1 -%}
      {% endif %}
    >
      {%- if enable_variant_boxes -%}
        <fieldset class="radio__fieldset">
          <legend class="radio__legend">
            <span class="radio__legend__label label-typography">{{- size_label -}}</span>
          </legend>

          {%- for i in (1..3) -%}
            {%- capture value -%}{%- cycle 'Small', 'Medium', 'Large' -%}{%- endcapture -%}
            <span class="radio__button">
              <input
                type="radio"
                class="radio__input"
                data-single-option-selector
                data-index="option2"
                name="size--{{ section.id }}"
                value="{{ value | escape_once }}"
                id="option-{{ value }}-1-{{ section.id }}"
                {% if forloop.index == 1 %}
                  checked
                {% endif %}
              >
              <label for="option-{{ value }}-1-{{ section.id }}" class="radio__label">
                <span>{{ value | escape_once }}</span>
              </label>
            </span>
          {%- endfor -%}
        </fieldset>
      {%- else -%}
        <div class="select__fieldset">
          <span class="radio__legend">
            <span class="radio__legend__label label-typography" id="onboarding-{{ section.id }}-option-1-label">
              {{- size_label -}}
            </span>
          </span>

          <popout-select class="select-popout" data-popout-prevent="true">
            <button
              type="button"
              class="select-popout__toggle"
              aria-expanded="false"
              aria-controls="onboarding-{{ section.id }}-option-1-list"
              aria-labelledby="onboarding-{{ section.id }}-option-1-label"
              data-popout-toggle
            >
              <span class="select-popout__value" data-popout-text>Small</span>
              {%- render 'icon-select' -%}
            </button>

            <div id="onboarding-{{ section.id }}-option-1-list" class="select-popout__list" data-popout-list>
              <ul class="select-popout__list__scroll">
                {%- for i in (1..3) -%}
                  {%- capture value -%}{%- cycle 'Small', 'Medium', 'Large' -%}{%- endcapture -%}
                  <li class="select-popout__item{% if forloop.index == 1 %} select-popout__item--current{% endif %}">
                    <a
                      class="select-popout__option"
                      href="#"
                      {% if forloop.index == 1 %}
                        aria-current="true"
                      {% endif %}
                      data-value="{{ value | escape_once }}"
                      data-popout-option
                    >
                      <span>
                        {{ value | escape_once }}
                      </span>
                    </a>
                  </li>
                {%- endfor -%}
              </ul>
            </div>
            <input
              type="hidden"
              name="options[Size]"
              id="onboarding-{{ section.id }}-option-1"
              value="White"
              data-popout-input
              data-single-option-selector
              data-index="option2"
            >
          </popout-select>
        </div>
      {%- endif -%}
    </div>
  </div>

  {%- if show_quantity -%}
    <div
      class="selector-wrapper{% if variants_style == 'boxes' %} selector-wrapper--qty{% endif %}"
      data-selector-wrapper
      {% if animations_enabled %}
        data-aos="hero"
        data-aos-anchor="{{ animation_anchor }}"
        data-aos-order="{{ animation_order }}"
        {%- assign animation_order = animation_order | plus: 1 -%}
      {% endif %}
    >
      {{ quantity_selector }}
    </div>
  {%- endif -%}

  <div class="product__submit__holder{% if show_payment_button %} product__submit__holder--spb{% endif %}">
    <div class="product__submit__buttons">
      <div
        class="product__submit__item"
        {% if animations_enabled %}
          data-aos="hero"
          data-aos-anchor="{{ animation_anchor }}"
          data-aos-order="{{ animation_order }}"
          {%- assign animation_order = animation_order | plus: 1 -%}
        {% endif %}
      >
        <button
          type="button"
          class="btn {{ atc_button_color }} {{ atc_button_style }} {{ atc_button_size }} btn--advanced btn--submit product__submit__add"
        >
          <hover-button></hover-button>
          {{- 'products.product.add_to_cart' | t -}}
          {%- if settings.atc_show_product_price -%}
            <span data-product-price class="product__price--regular">{{ product_price }}</span>
          {%- endif -%}
        </button>
      </div>
      {% if show_payment_button %}
        <div
          class="product__submit__item"
          {% if animations_enabled %}
            data-aos="hero"
            data-aos-anchor="{{ animation_anchor }}"
            data-aos-order="{{ animation_order }}"
            {%- assign animation_order = animation_order | plus: 1 -%}
          {% endif %}
        >
          <div class="shopify-payment-button">
            <button class="{{ buynow_btn_color }} {{ buynow_btn_style }} {{ buynow_button_size }} btn--advanced shopify-payment-button__button shopify-payment-button__button--unbranded">
              <hover-button></hover-button>
              Buy it now
            </button>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>
