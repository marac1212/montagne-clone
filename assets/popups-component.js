!function(){"use strict";class t{constructor(t,e){this.configuration={expires:null,path:"/",domain:window.location.hostname,sameSite:"none",secure:!0},this.name=t,this.value=e}write(){(-1!==document.cookie.indexOf("; ")&&!document.cookie.split("; ").find((t=>t.startsWith(this.name)))||-1===document.cookie.indexOf("; "))&&(document.cookie=`${this.name}=${this.value}; expires=${this.configuration.expires}; path=${this.configuration.path}; domain=${this.configuration.domain}; sameSite=${this.configuration.sameSite}; secure=${this.configuration.secure}`)}read(){if(-1!==document.cookie.indexOf("; ")&&document.cookie.split("; ").find((t=>t.startsWith(this.name)))){return document.cookie.split("; ").find((t=>t.startsWith(this.name))).split("=")[1]}return!1}destroy(){document.cookie.split("; ").find((t=>t.startsWith(this.name)))&&(document.cookie=`${this.name}=null; expires=${this.configuration.expires}; path=${this.configuration.path}; domain=${this.configuration.domain}; sameSite=${this.configuration.sameSite}; secure=${this.configuration.secure}`)}}let e=0,o=0,s=[];class i{constructor(t,e){if(this.popupContainer=t,this.popup=e,this.popupBody=e.querySelector("[data-popup-body]"),this.delay=t.dataset.popupDelay,this.isSubmitted=-1!==window.location.href.indexOf("accepts_marketing")||-1!==window.location.href.indexOf("customer_posted=true"),this.a11y=window.theme.a11y,this.showPopupOnScrollEvent=()=>this.showPopupOnScroll(),("always"===this.delay||this.isSubmitted)&&this.always(),this.delay&&this.delay.includes("delayed")&&!this.isSubmitted){const t=this.delay.includes("_")?parseInt(this.delay.split("_")[1]):10;this.delayed(t)}"bottom"!==this.delay||this.isSubmitted||this.bottom(),"idle"!==this.delay||this.isSubmitted||this.idle()}always(){this.showPopup()}delayed(t=10){setTimeout((()=>{this.showPopup()}),1e3*t)}bottom(){document.addEventListener("theme:scroll",this.showPopupOnScrollEvent)}idle(){if(!(!0===this.checkPopupTarget()))return;let t=0;const e=["mousemove","mousedown","click","touchmove","touchstart","touchend","keydown","keypress"],o=["load","resize","scroll"],s=()=>{t=setTimeout((()=>{t=0,this.showPopup()}),6e4),e.forEach((t=>{document.addEventListener(t,i)})),o.forEach((t=>{window.addEventListener(t,i)}))},i=()=>{t&&clearTimeout(t),e.forEach((t=>{document.removeEventListener(t,i)})),o.forEach((t=>{window.removeEventListener(t,i)})),s()};s()}showPopup(){window.theme.closeAllTooltips();const t={id:this.popup.id,body:this.popupBody};s.push(t);if(!0===this.checkPopupTarget()){if(o+=1,this.popup.classList.add("popup--visible"),this.popup.classList.contains("popup--bar")&&document.body.classList.add("popup-bar-is-visible"),this.a11y.trapFocus({container:this.popupBody}),this.popup.hasAttribute("data-prevent-scroll-lock"))return!1;this.scrollLock()}}checkPopupTarget(){const t=this.popup.parentNode.classList.contains("mobile"),e=this.popup.parentNode.classList.contains("desktop");return!(t&&window.innerWidth>=theme.sizes.small||e&&window.innerWidth<theme.sizes.small)}scrollLock(){document.dispatchEvent(new CustomEvent("theme:scroll:lock",{bubbles:!0,detail:this.popupBody}))}showPopupOnScroll(){window.scrollY+window.innerHeight>=document.body.clientHeight&&(this.showPopup(),document.removeEventListener("theme:scroll",this.showPopupOnScrollEvent))}unload(){document.removeEventListener("theme:scroll",this.showPopupOnScrollEvent)}}class p{constructor(t){if(this.popupContainer=t,this.locationPath=location.href,!this.popupContainer.hasAttribute("data-target-referrer"))return!1;-1!==this.locationPath.indexOf(this.popupContainer.getAttribute("data-target-referrer"))||window.Shopify.designMode||this.popupContainer.parentNode.removeChild(this.popupContainer)}}customElements.get("popup-large-promo")||customElements.define("popup-large-promo",class extends HTMLElement{constructor(){super(),this.popupContainer=this,this.cookie=new t(this.popupContainer.dataset.cookieName,"user_has_closed"),this.isTargeted=new p(this.popupContainer),this.delayShow=null,this.a11y=window.theme.a11y}connectedCallback(){this.popup=this.popupContainer.querySelector("[data-popup-inner]"),this.popupBody=this.popup.querySelector("[data-popup-body]"),this.popupId=this.popup.id,this.close=this.popup.querySelector("[data-popup-close]"),this.underlay=this.popup.querySelector("[data-popup-underlay]"),this.form=this.popup.querySelector("[data-newsletter-form]");!1!==this.cookie.read()&&!window.Shopify.designMode||(window.Shopify.designMode?this.showPopup():this.delayShow=new i(this.popupContainer,this.popup),this.form&&setTimeout((()=>{this.form.classList.contains("has-success")&&(this.showPopupIfNoCookie(),o-=1)})),this.initClosers())}checkPopupTarget(){const t=this.popup.parentNode.classList.contains("mobile"),e=this.popup.parentNode.classList.contains("desktop");return!(t&&window.innerWidth>=theme.sizes.small||e&&window.innerWidth<theme.sizes.small)}showPopupIfNoCookie(){this.showPopup()}initClosers(){this.close.addEventListener("click",this.closePopup.bind(this)),this.underlay.addEventListener("click",this.closePopup.bind(this)),this.popupContainer.addEventListener("keyup",(t=>{t.code===theme.keyboardKeys.ESCAPE&&this.closePopup(t)}))}closePopup(t){t.preventDefault(),this.hidePopup(),this.cookie.write()}scrollLock(){this.resetScrollUnlock(),this.a11y.trapFocus({container:this.popupBody}),document.dispatchEvent(new CustomEvent("theme:scroll:lock",{bubbles:!0,detail:this.popupBody}))}scrollUnlock(){this.resetScrollUnlock(),e=setTimeout((()=>{document.dispatchEvent(new CustomEvent("theme:scroll:unlock",{bubbles:!0}))}),300)}resetScrollUnlock(){e&&clearTimeout(e)}showPopup(){const t=!0===this.checkPopupTarget(),e={id:this.popupId,body:this.popup};s.push(e),t&&(o+=1,this.popup.classList.add("popup--visible"),this.scrollLock())}hidePopup(){this.popup.classList.remove("popup--visible");const t=s.findIndex((t=>t.id===this.popupId));if(o-=1,s.splice(t,1),1==o&&document.body.classList.contains("popup-bar-is-visible"))this.scrollUnlock();else if(o<1)this.scrollUnlock(),this.a11y.removeTrapFocus();else if(s.length>0){const t=s[s.length-1].body;this.a11y.trapFocus({container:t})}}disconnectedCallback(){this.scrollUnlock(),this.delayShow&&this.delayShow.unload()}}),customElements.get("popup-bar")||customElements.define("popup-bar",class extends HTMLElement{constructor(){super(),this.popupContainer=this,this.cookie=new t(this.popupContainer.dataset.cookieName,"user_has_closed"),this.isTargeted=new p(this.popupContainer),this.a11y=window.theme.a11y,this.delayShow=null}connectedCallback(){this.popup=this.popupContainer.querySelector("[data-popup-inner]"),this.popupBody=this.popup.querySelector("[data-popup-body]"),this.popupId=this.popup.id,this.close=this.popup.querySelector("[data-popup-close]"),this.underlay=this.popup.querySelector("[data-popup-underlay]"),this.toggle=this.popup.querySelector("[data-popup-bar-toggle]"),this.form=this.popup.querySelector("[data-newsletter-form]");!1!==this.cookie.read()&&!window.Shopify.designMode||(window.Shopify.designMode?this.showPopup():this.delayShow=new i(this.popupContainer,this.popup),this.initPopupToggleButton(),this.initClosers(),this.form&&setTimeout((()=>{this.form.classList.contains("has-success")&&this.showPopupIfNoCookie(),this.form.classList.contains("has-error")&&this.toggle.dispatchEvent(new Event("click"))})))}checkPopupTarget(){const t=this.popup.parentNode.classList.contains("mobile"),e=this.popup.parentNode.classList.contains("desktop");return!(t&&window.innerWidth>=theme.sizes.small||e&&window.innerWidth<theme.sizes.small)}showPopupIfNoCookie(){this.showPopup(),this.toggle.dispatchEvent(new Event("click"))}initPopupToggleButton(){this.toggle.addEventListener("click",(t=>{t.preventDefault(),this.popup.classList.toggle("popup--expanded"),this.popup.classList.contains("popup--expanded")?this.scrollLock():this.scrollUnlock()}))}showPopup(){const t={id:this.popupId,body:this.popup};s.push(t),this.a11y.trapFocus({container:this.popupBody});!0===this.checkPopupTarget()&&(o+=1,document.body.classList.add("popup-bar-is-visible"),this.popup.classList.add("popup--visible"))}hidePopup(){this.popup.classList.remove("popup--visible"),document.body.classList.remove("popup-bar-is-visible");const t=s.findIndex((t=>t.id===this.popupId));if(s.splice(t,1),o>=1&&(o-=1),o<1)this.scrollUnlock(),this.a11y.removeTrapFocus();else if(s.length>0){const t=s[s.length-1].body;this.a11y.trapFocus({container:t})}}initClosers(){this.close.addEventListener("click",this.closePopup.bind(this)),this.underlay.addEventListener("click",(()=>this.toggle.dispatchEvent(new Event("click")))),this.popupContainer.addEventListener("keyup",(t=>{t.code===theme.keyboardKeys.ESCAPE&&(this.popup.classList.remove("popup--expanded"),this.scrollUnlock())}))}closePopup(t){t.preventDefault(),this.cookie.write(),this.hidePopup()}scrollLock(){document.dispatchEvent(new CustomEvent("theme:scroll:lock",{bubbles:!0,detail:this.popupBody}))}scrollUnlock(){this.resetScrollUnlock(),e=setTimeout((()=>{document.dispatchEvent(new CustomEvent("theme:scroll:unlock",{bubbles:!0}))}),300)}resetScrollUnlock(){e&&clearTimeout(e)}disconnectedCallback(){this.scrollUnlock(),this.delayShow&&this.delayShow.unload()}})}();
